# 良いコード／悪いコードで学ぶ設計入門―保守しやすい 成長し続けるコードの書き方

## 基本情報

- https://gihyo.jp/book/2022/978-4-297-12783-1
    - 現時点で改訂版が出ている: https://gihyo.jp/book/2025/978-4-297-14622-1
- サポートページ: https://gihyo.jp/book/2022/978-4-297-12783-1/support
    - サンプルコードダウンロードもここから

## NOTE

### 総じて

- (既に理解している人間からすると)言いたいことはわかるが例えが悪い
    - 解釈を説明したい内容に都合の良いように捻じ曲げている
    - 対象読者(これから理解する人間)に正しく伝わるのだろうか？
- 本書の善悪の基準が独りよがりなので、複数人開発する力はつかないだろう
    - 読者は「この本に書いてあったから…」以上の説明ができない
- 「(オブジェクト指向)設計」と言っているのは詳細設計的な話で、いわゆるOODという用語から想起されるものとは異なる
    - のでこれを以て「設計」と連呼されるとそれはちょっと違うだろと言いたくなる
        - 本のタイトルが「コード」なのでそもそも上流の話を対象にしようとは思っていないのだろうが

### p.5, 1.3 データクラス

> データを保持するだけのクラスをデータクラスと
> 呼びます。

データクラスと呼んでいるのは誰か？次のように候補が色々あり曖昧。

- 本書ではそのようなクラスをデータクラスと
  呼びます
- Javaではそのようなクラスをデータクラスと呼びます
- 一般的にそのようなクラスはデータクラスと呼ばれます

本書の書き方だと一般的にデータクラスと呼ぶようにも読めてしまうが、そうではなく誤解を招く。
(対象読者が誰であるかを考えると、不適切な表現)

### p.19, 2.4 文脈(ドメイン知識)が共有できていないように思われる

あまり細かい説明なしに共有できるであろうドメインとしてRPGを選択しているのだと思われるが、著者の都合で一般的な解釈を捻じ曲げており、それが説明されないまま話が進んでいる。

- HPの最小値が0(自然数の性質)というのはHPクラスが持っているのは良いとして、HPの最大値はキャラクターの属性ではないのか？
- そもそも999とは何か？
- ダメージを受けたり回復する対象はHPなのか？

### p.23, 3.1 クラスとプロダクトの比較は粒度が違う

ヘッドホン、ドライヤーといった例はインターフェースが規格化されている話で合って、別に1つのクラスで実現すべきものではない。

外部から見てそうであればよいので、別に内部の実装は複数のクラスから構成されていても問題ない。

ドライヤーを1クラスで実装すべきであると言っているのなら良いがそうではないはず。
(むしろ、おそらく後ろの章では役割ごとにクラス分割しろみたいな話が出てくるのでは)

### p.28, 3.2.2

- なぜ異なる通貨の加算処理はエラーにするのか？「クラス単体で正常に動作するよう設計する(3.1)
  」「計算ロジックをデータ保持側に寄せる(3.2.2)」という主張からすると `Money` クラスで実現できるべきでは？
- なぜ実行時エラーなのか？「型で防止(3.2.6)」すればコンパイル時エラーにできるのでは？

著者が考える仕様における正しい実装、が本書の `Money` クラスなのだろうが、その仕様が読者と共有できていない。

### p.30 3.2.5 変数はなんでもfinal

この実装テクニックは私が携わるJavaプロジェクトでも強く推奨している。

EclipseやIntelliJ IDEAでは保存時変数にfinalを付けるオプションがあるのでそれを有効にすれば良い。

レビュー時にfinalがついていない変数を見つけたら、大体そこには問題がある。

### p.38, 3.4.2 値オブジェクト、完全コンストラクター

> 「値オブジェクト+ 完全コンストラクタ」は、オブジェクト指向設計の最も基本形を体現している構造のひとつといっても過言ではありません。

コンストラクターはプログラミング言語の機能であり、「実装」テクニックではあるかもしれないが「設計」では無いだろう。

何を「値オブジェクト」とするか(要は何をクラスとして定義するか)は設計のうちかもしれないが、あんまり設計の本質ではないように思う。
